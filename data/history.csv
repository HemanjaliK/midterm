import pandas as pd

# Initialize the DataFrame to store history
history_df = pd.DataFrame(columns=['Operation', 'Operand1', 'Operand2', 'Result'])

def load_history(filepath='history.csv'):
    global history_df
    try:
        history_df = pd.read_csv(filepath)
        print("History loaded successfully.")
    except FileNotFoundError:
        print("History file does not exist.")

def save_history(filepath='history.csv'):
    history_df.to_csv(filepath, index=False)
    print("History saved successfully.")

def clear_history():
    global history_df
    history_df = pd.DataFrame(columns=['Operation', 'Operand1', 'Operand2', 'Result'])
    print("History cleared.")

def delete_history_record(index):
    global history_df
    try:
        history_df = history_df.drop(index).reset_index(drop=True)
        print(f"Record {index} deleted successfully.")
    except KeyError:
        print("Invalid index. No record deleted.")

def add_to_history(operation, operand1, operand2, result):
    global history_df
    new_record = {'Operation': operation, 'Operand1': operand1, 'Operand2': operand2, 'Result': result}
    history_df = history_df.append(new_record, ignore_index=True)

def view_history():
    print(history_df)

# Example of using these functions in a REPL
def repl():
    while True:
        command = input("Enter command (load, save, clear, delete, view, exit): ")
        if command == 'exit':
            break
        elif command == 'load':
            load_history()
        elif command == 'save':
            save_history()
        elif command == 'clear':
            clear_history()
        elif command == 'delete':
            index = int(input("Enter the index of the record to delete: "))
            delete_history_record(index)
        elif command == 'view':
            view_history()
        else:
            print("Unknown command.")

if __name__ == "__main__":
    repl()
